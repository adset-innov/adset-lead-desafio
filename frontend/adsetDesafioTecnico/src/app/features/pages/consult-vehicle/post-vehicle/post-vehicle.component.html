<div class="car-form-container">
  <div class="form-header">
    <h2>{{ carData ? "Editar" : "Cadastrar" }} Veículo</h2>
  </div>

  <form [formGroup]="carForm" (ngSubmit)="onSubmitForm()" class="car-form">
    <!-- Dados Básicos -->
    <div class="form-section">
      <h3>Dados Básicos</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="marca">Marca *</label>
          <input
            type="text"
            id="marca"
            formControlName="marca"
            placeholder="Ex: Toyota"
            class="form-control"
            [class.error]="getFieldError('marca')"
          />
          <span class="error-message" *ngIf="getFieldError('marca')">
            {{ getFieldError("marca") }}
          </span>
        </div>

        <div class="form-group">
          <label for="modelo">Modelo *</label>
          <input
            type="text"
            id="modelo"
            formControlName="modelo"
            placeholder="Ex: Corolla"
            class="form-control"
            [class.error]="getFieldError('modelo')"
          />
          <span class="error-message" *ngIf="getFieldError('modelo')">
            {{ getFieldError("modelo") }}
          </span>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="ano">Ano *</label>
          <input
            type="number"
            id="ano"
            formControlName="ano"
            placeholder="Ex: 2023"
            class="form-control"
            [class.error]="getFieldError('ano')"
          />
          <span class="error-message" *ngIf="getFieldError('ano')">
            {{ getFieldError("ano") }}
          </span>
        </div>

        <div class="form-group">
          <label for="placa">Placa *</label>
          <input
            type="text"
            id="placa"
            formControlName="placa"
            placeholder="Ex: ABC1234 ou ABC1D23"
            class="form-control"
            style="text-transform: uppercase"
          />
          <span class="error-message" *ngIf="getFieldError('placa')">
            {{ getFieldError("placa") }}
          </span>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="km">Quilometragem</label>
          <input
            type="number"
            id="km"
            formControlName="km"
            placeholder="Ex: 50000"
            class="form-control"
            [class.error]="getFieldError('km')"
          />
          <span class="error-message" *ngIf="getFieldError('km')">
            {{ getFieldError("km") }}
          </span>
        </div>

        <div class="form-group">
          <label for="cor">Cor *</label>
          <select
            id="cor"
            formControlName="cor"
            class="form-control"
            [class.error]="getFieldError('cor')"
          >
            <option value="" disabled>Selecione a cor</option>
            <option *ngFor="let cor of cores" [value]="cor.value">
              {{ cor.label }}
            </option>
          </select>
          <span class="error-message" *ngIf="getFieldError('cor')">
            {{ getFieldError("cor") }}
          </span>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="preco">Preço *</label>
          <input
            type="number"
            id="preco"
            formControlName="preco"
            placeholder="Ex: 45000"
            step="0.01"
            class="form-control"
            [class.error]="getFieldError('preco')"
          />
          <span class="error-message" *ngIf="getFieldError('preco')">
            {{ getFieldError("preco") }}
          </span>
        </div>
      </div>
    </div>

    <!-- Opcionais -->
    <div class="form-section">
      <h3>Opcionais do Veículo</h3>
      <div class="checkbox-group">
        <label *ngFor="let opcional of opcionais" class="checkbox-label">
          <input
            type="checkbox"
            [checked]="isOpcionalSelected(opcional.value)"
            (change)="onOpcionalChange($event, opcional.value)"
            [disabled]="opcional.value === EnumOptionsCar.None"
          />
          <span class="checkmark"></span>
          {{ opcional.label }}
        </label>
      </div>
    </div>

    <!-- Portais e Categorias -->
    <div class="form-section">
      <h3>Portais e Categorias</h3>

      <div class="form-row">
        <div class="form-group">
          <label for="portal">Portal *</label>
          <select id="portal" formControlName="portal" class="form-control">
            <option *ngFor="let p of portals" [value]="p.value">
              {{ p.label }}
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="categoriaPortal">Categoria *</label>
          <select
            id="categoriaPortal"
            formControlName="categoriaPortal"
            class="form-control"
          >
            <option *ngFor="let c of categorias" [value]="c.value">
              {{ c.label }}
            </option>
          </select>
        </div>
      </div>
    </div>

    <!-- Botões -->
    <div class="form-actions">
      <button type="button" (click)="onCancelForm()" class="btn-cancel">
        Cancelar
      </button>
      <button type="submit" class="btn-submit">
       {{ dataextra.carData > 0 ? "Atualizar" : "Cadastrar" }}
      </button>
    </div>
  </form>
</div>
